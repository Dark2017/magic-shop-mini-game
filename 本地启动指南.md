# 本地启动指南

## 🚀 快速启动步骤

### 1. 安装微信开发者工具
1. 访问 [微信开发者工具官网](https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html)
2. 下载适合您系统的版本（Windows/Mac/Linux）
3. 安装并打开微信开发者工具

### 2. 创建项目
1. 打开微信开发者工具
2. 点击 "+" 创建新项目
3. **重要：先选择项目类型为"小游戏"**
4. 项目设置：
   ```
   项目名称: 魔法商店大亨
   目录: 选择本项目文件夹 (d:/wm/jh-game-web)
   AppID: 选择"不使用云服务，体验小游戏" （推荐）
   开发模式: 小游戏
   ```

### ⚠️ AppID选择说明
- **推荐方案**: 选择"不使用云服务，体验小游戏"，这样可以直接开始开发
- **如需真实AppID**: 需要单独申请小游戏AppID（与小程序AppID不同）

### 3. 导入项目代码
项目已经包含所有必要文件：
- `game.js` - 主入口文件
- `game.json` - 小游戏配置
- `project.config.json` - 项目配置
- `src/managers/` - 核心管理器代码

### 4. 启动游戏
1. 在微信开发者工具中点击 **编译** 按钮
2. 如果编译成功，会在模拟器中显示游戏界面
3. 使用鼠标点击模拟触摸操作

## 🔧 常见问题解决

### 问题1: AppID相关错误
**解决方案：**
1. 使用测试号：在创建项目时选择"不使用云服务"
2. 或在 `project.config.json` 中修改 appid 为您的真实AppID

### 问题2: 模块导入错误
**解决方案：**
确保所有文件路径正确，特别是 `game.js` 中的import语句：
```javascript
import AdManager from './src/managers/AdManager.js'
import DataManager from './src/managers/DataManager.js'
import GameManager from './src/managers/GameManager.js'
import UIManager from './src/managers/UIManager.js'
```

### 问题3: Canvas相关错误
**解决方案：**
在模拟器中可能会有Canvas相关警告，这是正常的，在真机上运行会正常

### 问题4: 广告API无法使用
**解决方案：**
开发环境中广告API会失败，这是正常的。需要：
1. 申请真实的广告位ID
2. 在真机上测试
3. 或暂时注释掉广告相关代码进行其他功能测试

## 🧪 测试功能

### 基础功能测试
1. **游戏启动**: 检查是否能正常显示游戏界面
2. **触摸交互**: 点击屏幕测试触摸响应
3. **工坊升级**: 测试升级按钮和数值变化
4. **数据保存**: 关闭重开检查数据是否保存

### 调试技巧
1. 使用 **Console 面板** 查看日志输出
2. 使用 **Storage 面板** 查看本地存储数据
3. 使用 **Network 面板** 监控网络请求（如广告API）

## 📱 真机预览

### 预览步骤
1. 在微信开发者工具中点击 **预览** 按钮
2. 扫描二维码
3. 在微信中打开游戏进行真机测试

### 真机测试重点
- 触摸操作流畅性
- 广告功能是否正常
- 性能表现
- 界面适配

## 🛠️ 开发调试

### 热重载
微信开发者工具支持热重载，修改代码后会自动刷新

### 调试面板
- **Console**: 查看console.log输出和错误信息
- **Sources**: 设置断点调试JavaScript代码
- **Storage**: 查看和修改本地存储数据
- **Network**: 监控网络请求

### 性能分析
- 使用 **Performance** 面板分析游戏性能
- 监控Canvas绘制性能
- 检查内存使用情况

## 📦 发布准备

### 上传代码
1. 在工具栏点击 **上传** 按钮
2. 填写版本号和项目备注
3. 上传到微信后台

### 提交审核
1. 登录微信公众平台
2. 进入小游戏管理后台
3. 提交版本审核

## 🔍 故障排除

### 常用命令
在开发者工具Console中可以执行：
```javascript
// 清除本地存储
wx.clearStorageSync()

// 查看游戏数据
wx.getStorageSync('gameData')

// 手动触发保存
dataManager.saveData()
```

### 重置项目
如果遇到无法解决的问题：
1. 删除 `project.config.json`
2. 重新创建项目
3. 重新导入代码

---

**提示**: 首次运行建议先在模拟器中测试基础功能，确认无误后再进行真机预览。
